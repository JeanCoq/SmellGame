<!DOCTYPE html>

<!-- Load images, CSS and JS files-->
{% load static %}

<html lang="fr" dir="ltr">
	
	<head>
		<title>Game page type (In Progress)</title>
		<meta charset="utf-8">
		<link rel="stylesheet" href="{% static 'css/design.css' %}">
		<link rel="icon" type="image/x-icon" href="{% static 'images/favicon.jpg' %}">
		<script type="text/javascript" src="{% static 'js/html2canvas.js' %}"></script>
		<script type="text/javascript" src="{% static 'js/jquery-2.1.1.min.js' %}"></script>
		
		<script>		
		function updateGradient(color, intensity) {
			endGradientPercent = 30*intensity/100+40;
			panelCenter = document.getElementById("panelCenter");
			panelCenter.style.background = "-webkit-radial-gradient("+color+" 0%, rgb(186,181,186) "+endGradientPercent+"%)";
			panelCenter.style.background = "-o-radial-gradient("+color+" 0%, rgb(186,181,186) "+endGradientPercent+"%)";
			panelCenter.style.background = "-moz-radial-gradient("+color+" 0%, rgb(186,181,186) "+endGradientPercent+"%)";
			panelCenter.style.background = "radial-gradient("+color+" 0%, rgb(186,181,186) "+endGradientPercent+"%)";
		}
		
		function updateNote(color) {
			panelNote = document.getElementById("panelNote");
			panelNote.style.background = color;
		}
		
		function updateImgGuessed(path) {
			img = document.getElementById("imgGuessed");
			img.style.display = "block";
			img.src = path;
		}
		
		function updateFeeling(feeling) {
			panelFeeling = document.getElementById("panelFeeling");
			opacity = feeling*70/100;
			panelFeeling.style.opacity = opacity/100;
			panelFeeling.style.filter = "alpha(opacity="+opacity+")";
		}
		
		function createImageFinal() {
			html2canvas($("#panelCenter"), {
				onrendered: function(canvas) {
					var imageUrl = canvas.toDataURL("image/png");
					var inputBase64 = document.getElementById("inputBase64"); 
					inputBase64.value = imageUrl;
				}
			});
		}
		</script>
	</head>
	
	
	<body>
		
		<div id="panelLeft">
			{% if guessStep == 1 %}
				<t1>Voici les échantillons que vous avez à analyser :</t1>
				<br/>
				<t1>{{ currentSamples }}</t1>
				
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<input type="image" value="SUIVANT" />
				</form>
				
			{% elif guessStep == 2 %}
				<t1>QUELLE EST L'INTENSITÉ DE CETTE ODEUR ?</t1>
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<div id="textRange" position="center">FORTE</div>
					<input type="range" min="0" max="100" step="1" value="50" orient="vertical" name="intensity" onchange="updateGradient('white' this.value)" oninput="updateGradient('white', this.value)"/>
					<div id="textRange" position="center">FAIBLE</div>
					<input type="image" value="SUIVANT" />
				</form>
			{% elif guessStep == 3 %}
				<t1>SI CETTE ODEUR EST ...</t1>
				<t2>UNE HUMEUR</t2>
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<div class="radio-toolbar">
						{% for humor in listHumors %}
							<input type="radio" id="radio{{ humor.id }}" value="{{ humor.id }}" name="humor" onchange="updateGradient('{{ humor.color }}', '{{ intensity }}')">
							<label for="radio{{ humor.id }}">{{ humor.name }} <br/></label><br/>
						{% endfor %}
					<input type="image" value="SUIVANT" />
					</div>
				</form>
			{% elif guessStep == 4 %}
				<t1>SI CETTE ODEUR EST ...</t1>
				<t2>UNE NOTE</t2>
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<div class="radio-toolbar">
						{% for note in listNotes %}
							<input type="radio" id="radio{{ note.id }}" value="{{ note.id }}" name="note" onchange="updateNote('{{ note.color }}')">
							<label for="radio{{ note.id }}">{{ note.name }} <br/></label><br/>
						{% endfor %}
					<input type="image" value="SUIVANT" />
					</div>
				</form>
			{% elif guessStep == 5 %}
				<t1>QUE VOUS ÉVOQUE CETTE ODEUR ?</t1>
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<div class="radio-toolbar">
						{% for image in listImages %}
							<input type="radio" id="radio{{ image.id }}" value="{{ image.id }}" name="image" onchange="updateImgGuessed('{% static image.pathImage %}')">
							<label for="radio{{ image.id }}">{{ image.name }} <br/></label><br/>
						{% endfor %}
					<input type="image" value="SUIVANT" />
					</div>
				</form>
			{% elif guessStep == 6 %}
				<t1>AIMEZ VOUS CETTE ODEUR ?</t1>
				<form action="{% url "SmellGuess.views.gameView" %}" method="post" >
					{% csrf_token %}
					<div id="textRange" position="center">NON</div>
					<input type="range" min="0" max="100" step="1" value="0" orient="vertical" onchange="updateFeeling(this.value)" oninput="updateFeeling(this.value)" name="feeling"/>
					<div id="textRange" position="center">OUI</div>
					<input type="image" value="SUIVANT" />
				</form>
			{% elif guessStep == 7 %}
				<t1>SI CETTE ODEUR AVAIT UN NOM ...</t1>
				<form action="{% url "SmellGuess.views.resultView" %}" method="post">
					{% csrf_token %}
					<input type="text" name="name">
					<input type="hidden" name="imageBase64" id="inputBase64" /> 
					<input type="image" value="SUIVANT" />
				</form>
			{% endif %}
			
			<!--</br></br></br></br></br></br></br></br></br></br>
			<nav>
		        <li><h3><a href="../home" style="border:1px solid #aaaaaa; margin:2px;">Return to homepage</a></h3>(delete data)</li>
		        </br>
		        <li><h3><a href="../registration" style="border:1px solid #aaaaaa; margin:2px;">Modify your profile</a></h3>(your current data are saved)</li>
			</nav>-->
		
		</div>
		
		<div id="panelCenter">
			<div id="panelNote"> </div>
			<img id="imgGuessed" src="" height="160" width="160" style="display:none;"> 
			<div id="panelFeeling"> </div>
		</div>
		
		<div id="panelHistory">
			HISTORIQUE :<br/>
			Sample n°{{ idSample }} (guessStep= {{ guessStep }})<br/>
			{% if guessStep >= 3 %}
				Intensité : {{ intensity }}% <br/>
			{% endif %}
			{% if guessStep >= 4 %}
				Humeur : {{ humor.name }} <br/>
			{% endif %}
			{% if guessStep >= 5 %}
				Note : {{ note.name }} <br/>
			{% endif %}
			{% if guessStep >= 6 %}
				Image : {{ image.name }} <br/>
			{% endif %}
			{% if guessStep >= 7 %}
				Appréciation : {{ feeling }}% NÉGATIVE <br/>
			{% endif %}
		</div>
		
		<div id="panelLogo" style="background-image: url('{% static 'images/logo150x150.png' %}');"> </div>
		<p class="fl_left" style="position: fixed; bottom: 0; right:5px" >Copyright &copy; 2014 - All Rights Reserved - <a href="https://github.com/JeanCoq/SmellGame">Sources</a></p>
	</body>
	
	<script>
	{% if guessStep >= 3 %}
		updateGradient('white', '{{ intensity }}');
	{% endif %}
	{% if guessStep >= 4 %}
		updateGradient('{{ humor.color }}', '{{ intensity }}');
	{% endif %}
	{% if guessStep >= 5 %}
		updateNote('{{ note.color }}');
	{% endif %}
	{% if guessStep >= 6 %}
		updateImgGuessed('{% static image.pathImage %}');
	{% endif %}
	{% if guessStep >= 7 %}
		updateFeeling('{{ feeling }}');
		createImageFinal();
	{% endif %}
	</script>
	
</html>